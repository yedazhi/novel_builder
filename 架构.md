# 框架选择：
前端采用 vue3
用 docker-compose 部署

# 约束：
前端用 typescript 和 eslint 进行格式验证

# 结构
前端服务直接和dify进行通信和交互，基本上就是 workflow API ,需要配置下API的token和服务地址

# 数据
刚开始就保存到 web 浏览器本地就行了

# 其他
* 前端页面只在手机上使用，部署后，可以在局域网内打开来进行使用
 
# 文生图实现逻辑
1. 首先在 backend/text2img 下添加 comfyui api 的 json ，然后在 docker-compose 的 backend 环境变量中，指定文生图的 json 相对路径
2. 提供一个 API 接口 【开始配图】，请求参数是： 
novel_content： 需要插入图片的小说内容
roles： 出场角色信息
require： 配图要求
chapter_id: 章节ID，唯一标识章节

无返回数据
3. 提供再提供一个 API 接口 【获取文章配图】，请求参数是：
chapter_id: 章节ID，唯一标识章节

返回数据：
当配图还没有生成完成的时候，返回图片生成中

配图生成完成，就返回以下列表
[
    {
        index:xx 插入在第 index 段的后面
        img_url: http://host/img_url 图片的地址
    }
]

4. 关于生图逻辑的详细实现：
在收到生图请求的时候，首先把 文章内容，角色信息，要求 发送给 dify 的一个工作流，这个工作流会返回以下列表：
[
{
    index:xx 插入的段落位置，
    img_prompt: 提示词信息
}
]
收到生成的提示词之后，再调用 comfyui 生成图片。 comfyui 生成图片需要时间，如果用户请求结果，那么就判断下 comfyui 所有的图片任务是不是都生成好了。

如果都生成好了，那么就生成返回结果给用户