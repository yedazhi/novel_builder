# 人物卡生成功能开发计划

## 任务描述
在人物卡编辑页面添加一个生成人物卡的功能，点击后调用接口。

## 功能流程
1. 在人物卡编辑页面顶部添加"生成人物卡"按钮
2. 点击按钮弹出输入框，要求用户输入生成要求
3. 用户确认后调用 `generateRoleCardImagesApiRoleCardGeneratePost` 接口
4. API 调用成功后显示提示："图片生成中，请耐心等待"

## 实施步骤

### ✅ 步骤 1：在 ApiServiceWrapper 中添加角色卡生成方法
- 文件：`lib/services/api_service_wrapper.dart`
- 添加 `generateRoleCardImages` 方法
- 使用直接 HTTP 调用简化实现

### ✅ 步骤 2：创建角色卡输入弹框组件
- 文件：`lib/widgets/role_card_input_dialog.dart`
- 创建可复用的输入弹框组件
- 包含用户提示和验证

### ✅ 步骤 3：在人物编辑页面集成生成功能
- 文件：`lib/screens/character_edit_screen.dart`
- 在 AppBar 添加生成按钮（仅在输入姓名后显示）
- 实现完整的用户交互流程
- 构建角色数据传递给 API

### ✅ 步骤 4：添加必要的导入和依赖
- 更新导入语句
- 确保所有依赖正确
- 清理未使用的导入

### ✅ 步骤 5：测试和验证功能
- 编译测试：通过 `flutter analyze` 检查
- 代码质量：无错误或警告
- 功能完整性：所有方法正确实现

## 实现结果

✅ **功能完整实现**：
1. **顶部按钮**：在人物编辑页面 AppBar 中添加"生成人物卡"按钮
2. **输入弹框**：点击按钮弹出输入框，要求用户输入生成要求
3. **API 调用**：用户确认后调用 `/api/role-card/generate` 接口
4. **成功提示**：API 调用成功后显示"图片生成中，请耐心等待"
5. **错误处理**：完整的错误处理和用户反馈

✅ **代码质量**：
- 所有文件通过 `flutter analyze` 检查
- 无语法错误或类型错误
- 清理了未使用的导入和依赖

✅ **用户体验**：
- 按钮仅在输入角色姓名后显示
- 加载状态显示和禁用处理
- 友好的错误提示和成功反馈

## 技术要点
- 使用现有的 `RoleCardGenerateRequest` 模型
- 从当前人物信息构建 `roles` 字段
- Material Design UI 风格
- 错误处理和用户反馈