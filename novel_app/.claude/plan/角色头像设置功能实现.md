# 角色头像设置功能实现

## 任务描述
我思考了下，置顶功能没有意义，帮我把置顶逻辑调整下,改成设置为头像，点击之后，可以设置为 角色管理页面 中角色卡展示的图片，同时在 角色编辑页面中，也展示这个被设置为头像的图片

## 选择的方案
方案 1：本地缓存方案 - 独立头像缓存，稳定快速

## 实施步骤

### 1. 创建头像管理服务
- 新建 character_avatar_service.dart
- 实现头像设置、获取、删除功能
- 集成 CharacterImageCacheService

### 2. 扩展数据库服务
- 添加 updateCharacterAvatar() 方法
- 添加 getCharacterAvatar() 方法
- 添加头像相关的数据库查询逻辑

### 3. 修改图集浏览页面
- 替换 _onPinImage() 为 _onSetAsAvatar()
- 修改按钮文案："置顶" → "设为头像"
- 修改图标和颜色
- 集成头像设置服务

### 4. 更新图集操作面板
- 修改按钮文案和图标
- 更新 UI 样式

### 5. 修改角色管理页面
- 添加头像显示功能
- 使用圆形头像展示

### 6. 修改角色编辑页面
- 添加头像显示区域
- 整合头像服务

### 7. 移除置顶相关逻辑
- 清理 RoleGallery 中的置顶方法
- 移除置顶排序逻辑
- 清理 isPinned 相关代码

## 技术要点
- 使用 CharacterImageCacheService 进行图片缓存
- 数据库持久化头像路径和原始文件名
- 头像与图集图片分离存储
- 统一的头像管理服务

## 预期结果
- 角色管理页面显示头像（圆形，50px）
- 角色编辑页面显示头像（方形，80px）
- 头像设置持久化
- UI/UX 优化，用户体验提升